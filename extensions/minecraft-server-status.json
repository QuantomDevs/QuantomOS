{
  "id": "minecraft-server-status",
  "name": "Minecraft Server Status",
  "title": "Minecraft Status",
  "version": "1.0.2",
  "author": "AI Assistant",
  "description": "Zeigt den Online-Status, die Version und die Spielerzahl eines Minecraft-Java-Servers an.",
  "settings": [
    {
      "id": "serverUrl",
      "name": "Minecraft Server URL",
      "type": "text",
      "defaultValue": "play.hypixel.net",
      "description": "Die URL oder IP-Adresse des Minecraft-Servers (z. B. demo.mcstatus.io)."
    },
    {
      "id": "refreshInterval",
      "name": "Aktualisierungsintervall (Sekunden)",
      "type": "number",
      "defaultValue": 60,
      "description": "Wie oft die Serverinformationen aktualisiert werden sollen. 0 zum Deaktivieren."
    }
  ],
  "html": "<div class=\"mc-widget-container\"><div class=\"view-container\" id=\"loading-view\"><p>Lade Server-Status...</p></div><div class=\"view-container\" id=\"error-view\" style=\"display: none;\"><p class=\"error-message\"></p></div><div class=\"view-container mc-server-view\" id=\"online-view\" style=\"display: none;\"><div class=\"mc-icon\"><img src=\"\" alt=\"Server Icon\"/></div><div class=\"mc-info\"><div class=\"mc-header\"><span class=\"server-host\"></span><span class=\"status-dot online\"></span></div><ul class=\"mc-details\"><li><span class=\"server-version\"></span></li><li><span class=\"player-count-wrapper\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path d=\"M10 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM3.465 14.493a1.23 1.23 0 0 0 .41 1.412A9.957 9.957 0 0 0 10 18c2.31 0 4.438-.784 6.131-2.1.43-.333.604-.903.41-1.412A6.972 6.972 0 0 0 10 11.5a6.972 6.972 0 0 0-6.535 2.993Z\"/></svg><span class=\"player-count\"></span></span></li></ul></div></div><div class=\"view-container mc-server-view\" id=\"offline-view\" style=\"display: none;\"><div class=\"mc-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M1 5.25A2.25 2.25 0 0 1 3.25 3h13.5A2.25 2.25 0 0 1 19 5.25v9.5A2.25 2.25 0 0 1 16.75 17H3.25A2.25 2.25 0 0 1 1 14.75v-9.5Zm1.5 5.81v3.69c0 .414.336.75.75.75h13.5a.75.75 0 0 0 .75-.75v-2.69l-2.22-2.219a.75.75 0 0 0-1.06 0l-1.91 1.909.47.47a.75.75 0 1 1-1.06 1.06L6.53 8.091a.75.75 0 0 0-1.06 0l-2.97 2.97ZM12 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z\" clip-rule=\"evenodd\"/></svg></div><div class=\"mc-info\"><div class=\"mc-header\"><span class=\"server-host\"></span><span class=\"status-dot offline\"></span></div><ul class=\"mc-details\"><li><span>Offline</span></li></ul></div></div></div>",
  "css": ".mc-widget-container { width: 100%; height: 100%; padding: 1rem; display: flex; align-items: center; font-family: var(--font-family-primary, sans-serif); color: var(--color-primary-text, #fff); } .view-container { width: 100%; } .mc-server-view { display: flex; align-items: center; gap: 12px; } .mc-icon { width: 40px; height: 40px; flex-shrink: 0; border-radius: 4px; display: flex; justify-content: center; align-items: center; overflow: hidden; background: var(--color-secondary-background, #333); } .mc-icon img { width: 100%; height: 100%; object-fit: contain; } .mc-icon svg { width: 32px; height: 32px; opacity: 0.5; } .mc-info { flex-grow: 1; min-width: 0; } .mc-header { display: flex; align-items: center; gap: 8px; font-size: 1.1rem; font-weight: 600; color: var(--color-primary-text, #fff); margin-bottom: 4px; } .server-host { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } .status-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; } .status-dot.online { background-color: var(--color-success, #28a745); } .status-dot.offline { background-color: var(--color-error, #dc3545); } .mc-details { display: flex; list-style: none; padding: 0; margin: 0; gap: 12px; font-size: 0.9rem; color: var(--color-secondary-text, #aaa); } .mc-details li { position: relative; } .mc-details li:not(:last-child)::after { content: 'â€¢'; position: absolute; right: -7px; top: 0; } .player-count-wrapper { display: inline-flex; align-items: center; gap: 4px; } .player-count-wrapper svg { width: 1em; height: 1em; } .error-message { color: var(--color-warning, #ffc107); }",
  "javascript": "const serverUrl = '{{serverUrl}}';\nconst refreshInterval = {{refreshInterval}} * 1000;\n\nconst loadingView = shadowRoot.querySelector('#loading-view');\nconst errorView = shadowRoot.querySelector('#error-view');\nconst onlineView = shadowRoot.querySelector('#online-view');\nconst offlineView = shadowRoot.querySelector('#offline-view');\n\nfunction showView(viewToShow) {\n    if (!loadingView || !errorView || !onlineView || !offlineView) return;\n    loadingView.style.display = 'none';\n    errorView.style.display = 'none';\n    onlineView.style.display = 'none';\n    offlineView.style.display = 'none';\n    if (viewToShow) {\n        const displayStyle = (viewToShow === onlineView || viewToShow === offlineView) ? 'flex' : 'block';\n        viewToShow.style.display = displayStyle;\n    }\n}\n\nasync function fetchWithTimeout(resource, timeout = 8000) {\n    const controller = new AbortController();\n    const id = setTimeout(() => controller.abort(), timeout);\n    const response = await fetch(resource, { signal: controller.signal });\n    clearTimeout(id);\n    return response;\n}\n\nasync function fetchStatus() {\n    if (!serverUrl || serverUrl.trim() === '') {\n        showView(errorView);\n        errorView.querySelector('.error-message').textContent = 'Bitte gib eine Server-Adresse an.';\n        return;\n    }\n\n    try {\n        showView(loadingView);\n        const response = await fetchWithTimeout(`https://api.mcstatus.io/v2/status/java/${serverUrl}`);\n        \n        if (!response.ok) {\n            let errorMsg = `API-Fehler (Status ${response.status})`;\n            try {\n                const errorData = await response.json();\n                errorMsg = errorData.error || errorMsg;\n            } catch (e) { /* Ignore if response is not JSON */ }\n            throw new Error(errorMsg);\n        }\n\n        const data = await response.json();\n\n        if (data.online) {\n            onlineView.querySelector('.mc-icon img').src = data.icon;\n            onlineView.querySelector('.server-host').textContent = data.host;\n            onlineView.querySelector('.server-version').textContent = data.version.name_clean;\n            onlineView.querySelector('.player-count').textContent = `${data.players.online} / ${data.players.max}`;\n            showView(onlineView);\n        } else {\n            offlineView.querySelector('.server-host').textContent = serverUrl;\n            showView(offlineView);\n        }\n    } catch (error) {\n        showView(errorView);\n        let errorMessage = error.name === 'AbortError' ? 'Timeout: Die API-Anfrage hat zu lange gedauert.' : error.message;\n        errorView.querySelector('.error-message').textContent = `Fehler: ${errorMessage}`;\n        console.error('Minecraft Status Fehler:', error);\n    }\n}\n\nlet intervalId = null;\nfunction start() {\n    if (intervalId) {\n        clearInterval(intervalId);\n    }\n    fetchStatus();\n    if (refreshInterval > 0) {\n       intervalId = setInterval(fetchStatus, refreshInterval);\n    }\n}\n\nstart();"
}